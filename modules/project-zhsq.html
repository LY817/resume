<li>
    <h3>湖北电信聚翼智慧社区</h3>
</li>
<p>
    【概述】<br />
     作为社区信息汇聚平台，将人、地、事、物等要素全部纳入网格进行管理<br />
     汇聚不同设备厂商的数据，发掘并发挥数据的价值<br />
     增强社区治安管理，提升物业服务质量<br />
    【职责描述】<br />
     我作为项目的主要开发者，全程参与了项目从0到1的整个过程<br />
     - 产品业务需求分析<br />
     - 技术选型、功能的设计与落地实现<br/>
     - 安防设备厂家的接口对接联调<br/>
    【项目介绍】<br />
     📆&nbsp;&nbsp;<b>2018-11 ~ 2019-03 原型开发</b><br />
     开发原型产品，并在几个湖北电信的园区中开始试点使用<br/>
     ⚙️&nbsp;&nbsp;<b>技术选型</b><br />
     后端技术栈使用SpringBoot + Dubbo + MyBatis<br/>
     初期分为前端接口服务和数据库操作服务，服务之间通过Dubbo远程调用，通过multicast组网广播实现服务发现<br/>
     使用MySQL作为数据存储<br/>
     使用Redis保存用户登录信息以及字典缓存<br/>
     使用fastDFS存放上传的图片文件<br/>
     📆&nbsp;&nbsp;<b>2019-04 ~ 2020-06 功能迭代/重构改造</b><br />
     逐步在武汉以及湖北地级市推广，接入的社区数量开始增加。随着系统访问量的上升，原来的"all-in-DB"的架构模式逐渐跟不上业务的性能需求，引入其他中间件和分布式解决方案来优化系统性能<br/>
<!--     主要是通行记录相关的业务，以及大量的定时任务、轮训操作-->
     解耦/拆分:根据业务领域划分子模块<br/>
     将最初的一个数据库访问服务按照业务领域拆分为几个单独Dubbo服务<br/>
     将设备厂家的对接逻辑独立为可以单独部署的应用，通过事件总结与业务系统交互，使用微服务组件来统一管理各个服务的状态和配置<br/>
     ⚙️&nbsp;&nbsp;<b>技术选型</b><br />
     - 使用RocketMQ作为业务事件总线<br />
     - 使用MongoDB存储通行记录数据<br/>
     - 使用Nacos来做配置管理和服务管理<br />
    【细节/亮点】<br />
    💡 <b>事件总线</b><br />
     - 数据分发：数据对接过程中，解耦了业务系统与多家设备厂家的对接逻辑；通过消息中间件实现"柔性远程调用"，提高数据分发过程的可靠性<br />
    &nbsp;&nbsp;&nbsp;根据设备对接的业务需求，定义消息生产者和消息消费者之间交互的"API"<br />
    &nbsp;&nbsp;&nbsp;根据tag来定义数据模型和增删改操作、根据topic来区分厂家<br/>
    &nbsp;&nbsp;&nbsp;消息生产者：在业务系统逻辑中使用自定义注解 + AOP实现在业务逻辑中埋点，将操作动作和操作参数作为消息发送到MQ<br/>
    &nbsp;&nbsp;&nbsp;消息消费者：利用SpringBoot的SPI机制实现自定义的starter，封装mq消息的"订阅配置-消费-分发"逻辑<br/>
    &nbsp;&nbsp;&nbsp;根据消息生产者和消息消费者之间定义的交互"API"定义了一套对应的Java接口暴露给对接开发者<br/>
    &nbsp;&nbsp;&nbsp;接口的实现类作为component注册到Spring容器中<br/>
    &nbsp;&nbsp;&nbsp;根据消息tag映射到对应接口方法，利用反射调用Spring容器中对应实现类的方法<br/>
    &nbsp;&nbsp;&nbsp;根据对应数据模型的主键作为路由key和客户端顺序消费API来保证数据操作的顺序性<br/>
    &nbsp;&nbsp;&nbsp;利用死信队列将重试失败的消息生成告警进入人工维护兜底<br/>
<!--    消息通知、存到告警表-->
    - 事件驱动：实现事件相关业务场景如布控、告警，取代原来数据库轮训的实现方式<br />
    &nbsp;&nbsp;&nbsp;将安防设备上报的人脸识别、车辆通行记录作为事件源，业务系统定义统一的事件上报接口，将上报数据投递到RocketMQ<br/>
    &nbsp;&nbsp;&nbsp;对接服务根据对接厂商不同的事件获取实现形式获取通行记录数据，经过数据映射、图片上传，调用统一的接口上报<br/>
    &nbsp;&nbsp;&nbsp;入库服务、布控规则服务、前端大屏WebSocket推送、人脸识别训练以及后面新增的下游业务都作为一个独立的消费者组消费通行记录topic<br/>

    💡 <b>服务治理</b><br />
    - 使用Nacos来管理众多厂家对接服务的配置<br />
    &nbsp;&nbsp;&nbsp;因为存在多种对接方式如SaaS平台rest接口对接模式、设备直连模式（tcp长连接、http接口）、云平台对接等<br/>
    &nbsp;&nbsp;&nbsp;会根据对接方式和社区的不同,创建独立的对接服务<br/>
<!--    根据具体场景的对接模式，实现事件总线定义的接口，来实现社区设备与业务系统的交互（元数据、指令下发与事件上报）<br/>-->
    💡 <b>中间件应用</b><br />
    - 映射查询的缓存设计<br />
    &nbsp;&nbsp;&nbsp;开始是直接查数据库，当数据量上来之后发现数据库查询出现瓶颈<br />
    - 使用redis中的bitmap数据结构实现人员布控、区域巡检打卡等业务场景<br />
    - 将通行记录数据存储从MySQL迁移到MongoDB<br />
    &nbsp;&nbsp;&nbsp;原生支持分布式部署，便于横向扩展、分片<br/>
    &nbsp;&nbsp;&nbsp;灵活的扩展字段，适用于异构数据存储，如：测量体温、是否带口罩等<br/>
<!--    &nbsp;&nbsp;&nbsp;反范式：在数据映射过程中查询出全量数据<br/>-->
    【我的收获】<br/>
    - Dubbo、Nacos、RocketMQ等分布式系统的相关解决方案的实践经验<br/>
    - 实践了SpringBoot使用的各种姿势<br/>
</p>
<br />
<hr>